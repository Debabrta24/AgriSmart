<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AgriSmart - AI-Powered Crop Recommendation System</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        /* Reset and base styles */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --background: hsl(0, 0%, 100%);
            --foreground: hsl(222.2, 84%, 4.9%);
            --card: hsl(0, 0%, 100%);
            --card-foreground: hsl(222.2, 84%, 4.9%);
            --primary: hsl(142, 76%, 36%);
            --primary-foreground: hsl(355.7, 100%, 97.3%);
            --secondary: hsl(25, 45%, 42%);
            --secondary-foreground: hsl(0, 0%, 98%);
            --muted: hsl(210, 40%, 96%);
            --muted-foreground: hsl(215.4, 16.3%, 46.9%);
            --accent: hsl(210, 40%, 96%);
            --accent-foreground: hsl(222.2, 84%, 4.9%);
            --destructive: hsl(0, 84.2%, 60.2%);
            --destructive-foreground: hsl(210, 40%, 98%);
            --border: hsl(214.3, 31.8%, 91.4%);
            --input: hsl(214.3, 31.8%, 91.4%);
            --ring: hsl(142, 76%, 36%);
            --radius: 0.5rem;
        }

        .dark {
            --background: hsl(222.2, 84%, 4.9%);
            --foreground: hsl(210, 40%, 98%);
            --card: hsl(222.2, 84%, 4.9%);
            --card-foreground: hsl(210, 40%, 98%);
            --primary: hsl(142, 76%, 36%);
            --primary-foreground: hsl(355.7, 100%, 97.3%);
            --secondary: hsl(217.2, 32.6%, 17.5%);
            --secondary-foreground: hsl(210, 40%, 98%);
            --muted: hsl(217.2, 32.6%, 17.5%);
            --muted-foreground: hsl(215, 20.2%, 65.1%);
            --accent: hsl(217.2, 32.6%, 17.5%);
            --accent-foreground: hsl(210, 40%, 98%);
            --destructive: hsl(0, 62.8%, 30.6%);
            --destructive-foreground: hsl(210, 40%, 98%);
            --border: hsl(217.2, 32.6%, 17.5%);
            --input: hsl(217.2, 32.6%, 17.5%);
            --ring: hsl(142, 76%, 36%);
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--background);
            color: var(--foreground);
            line-height: 1.5;
        }

        /* Utility classes */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 1rem;
        }

        .grid {
            display: grid;
        }

        .grid-cols-1 {
            grid-template-columns: repeat(1, minmax(0, 1fr));
        }

        .grid-cols-2 {
            grid-template-columns: repeat(2, minmax(0, 1fr));
        }

        .lg\:grid-cols-2 {
            grid-template-columns: repeat(1, minmax(0, 1fr));
        }

        .gap-4 {
            gap: 1rem;
        }

        .gap-6 {
            gap: 1.5rem;
        }

        .gap-8 {
            gap: 2rem;
        }

        .flex {
            display: flex;
        }

        .items-center {
            align-items: center;
        }

        .justify-center {
            justify-content: center;
        }

        .justify-between {
            justify-content: space-between;
        }

        .text-center {
            text-align: center;
        }

        .font-bold {
            font-weight: 700;
        }

        .font-semibold {
            font-weight: 600;
        }

        .font-medium {
            font-weight: 500;
        }

        .text-xs {
            font-size: 0.75rem;
        }

        .text-sm {
            font-size: 0.875rem;
        }

        .text-lg {
            font-size: 1.125rem;
        }

        .text-xl {
            font-size: 1.25rem;
        }

        .text-2xl {
            font-size: 1.5rem;
        }

        .text-3xl {
            font-size: 1.875rem;
        }

        .mb-2 {
            margin-bottom: 0.5rem;
        }

        .mb-3 {
            margin-bottom: 0.75rem;
        }

        .mb-4 {
            margin-bottom: 1rem;
        }

        .mb-6 {
            margin-bottom: 1.5rem;
        }

        .mt-4 {
            margin-top: 1rem;
        }

        .mt-6 {
            margin-top: 1.5rem;
        }

        .mt-8 {
            margin-top: 2rem;
        }

        .mt-12 {
            margin-top: 3rem;
        }

        .p-4 {
            padding: 1rem;
        }

        .p-5 {
            padding: 1.25rem;
        }

        .p-6 {
            padding: 1.5rem;
        }

        .py-6 {
            padding-top: 1.5rem;
            padding-bottom: 1.5rem;
        }

        .py-8 {
            padding-top: 2rem;
            padding-bottom: 2rem;
        }

        .py-12 {
            padding-top: 3rem;
            padding-bottom: 3rem;
        }

        .px-4 {
            padding-left: 1rem;
            padding-right: 1rem;
        }

        .w-full {
            width: 100%;
        }

        .h-4 {
            height: 1rem;
        }

        .h-5 {
            height: 1.25rem;
        }

        .h-8 {
            height: 2rem;
        }

        .h-10 {
            height: 2.5rem;
        }

        .h-12 {
            height: 3rem;
        }

        .h-16 {
            height: 4rem;
        }

        .w-4 {
            width: 1rem;
        }

        .w-5 {
            width: 1.25rem;
        }

        .w-8 {
            width: 2rem;
        }

        .w-10 {
            width: 2.5rem;
        }

        .w-12 {
            width: 3rem;
        }

        .w-16 {
            width: 4rem;
        }

        .min-h-screen {
            min-height: 100vh;
        }

        .rounded-lg {
            border-radius: var(--radius);
        }

        .rounded-full {
            border-radius: 9999px;
        }

        .border {
            border-width: 1px;
            border-color: var(--border);
        }

        .shadow-lg {
            box-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
        }

        /* Component styles */
        .gradient-bg {
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
        }

        .card {
            background-color: var(--card);
            color: var(--card-foreground);
            border-radius: var(--radius);
            border: 1px solid var(--border);
        }

        .button {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            white-space: nowrap;
            border-radius: calc(var(--radius) - 2px);
            font-size: 0.875rem;
            font-weight: 500;
            transition: colors 0.2s;
            padding: 0.5rem 1rem;
            height: 2.5rem;
            border: none;
            cursor: pointer;
        }

        .button-primary {
            background-color: var(--primary);
            color: var(--primary-foreground);
        }

        .button-primary:hover {
            background-color: hsl(142, 76%, 32%);
        }

        .button-primary:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .button-outline {
            border: 1px solid var(--border);
            background-color: var(--background);
            color: var(--foreground);
        }

        .button-outline:hover {
            background-color: var(--accent);
        }

        .input {
            display: flex;
            height: 2.5rem;
            width: 100%;
            border-radius: calc(var(--radius) - 2px);
            border: 1px solid var(--input);
            background-color: var(--background);
            padding: 0.5rem 0.75rem;
            font-size: 0.875rem;
            transition: border-color 0.2s, box-shadow 0.2s;
        }

        .input:focus {
            outline: none;
            border-color: var(--ring);
            box-shadow: 0 0 0 2px hsl(var(--ring) / 0.2);
        }

        .label {
            font-size: 0.875rem;
            font-weight: 500;
            color: var(--foreground);
            margin-bottom: 0.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .badge {
            display: inline-flex;
            align-items: center;
            border-radius: 9999px;
            border: 1px solid transparent;
            padding: 0.125rem 0.625rem;
            font-size: 0.75rem;
            font-weight: 600;
            transition: colors 0.2s;
        }

        .badge-default {
            background-color: var(--primary);
            color: var(--primary-foreground);
        }

        .badge-secondary {
            background-color: var(--secondary);
            color: var(--secondary-foreground);
        }

        .badge-outline {
            color: var(--foreground);
            border-color: var(--border);
        }

        .alert {
            position: relative;
            width: 100%;
            border-radius: var(--radius);
            border: 1px solid var(--border);
            padding: 1rem;
        }

        .alert-destructive {
            border-color: hsl(var(--destructive) / 0.5);
            color: var(--destructive);
        }

        /* Icons */
        .icon {
            display: inline-block;
            width: 1em;
            height: 1em;
            stroke-width: 2;
            stroke: currentColor;
            fill: none;
        }

        /* Animation classes */
        .animate-spin {
            animation: spin 1s linear infinite;
        }

        .fade-in {
            animation: fadeIn 0.5s ease-in;
        }

        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Color utilities */
        .text-primary {
            color: var(--primary);
        }

        .text-muted-foreground {
            color: var(--muted-foreground);
        }

        .text-destructive {
            color: var(--destructive);
        }

        .text-blue-500 {
            color: #3b82f6;
        }

        .text-blue-400 {
            color: #60a5fa;
        }

        .text-red-500 {
            color: #ef4444;
        }

        .text-purple-500 {
            color: #a855f7;
        }

        .text-green-500 {
            color: #22c55e;
        }

        .text-yellow-500 {
            color: #eab308;
        }

        .bg-primary\/5 {
            background-color: hsl(var(--primary) / 0.05);
        }

        .bg-primary\/10 {
            background-color: hsl(var(--primary) / 0.1);
        }

        .bg-primary\/20 {
            background-color: hsl(var(--primary) / 0.2);
        }

        .bg-accent\/30 {
            background-color: hsl(var(--accent) / 0.3);
        }

        .bg-muted\/30 {
            background-color: hsl(var(--muted) / 0.3);
        }

        .bg-secondary\/20 {
            background-color: hsl(var(--secondary) / 0.2);
        }

        .bg-background\/50 {
            background-color: hsl(var(--background) / 0.5);
        }

        .bg-green-100 {
            background-color: #dcfce7;
        }

        .text-green-800 {
            color: #166534;
        }

        .bg-orange-100 {
            background-color: #fed7aa;
        }

        .text-orange-800 {
            color: #9a3412;
        }

        .bg-gray-100 {
            background-color: #f3f4f6;
        }

        .text-gray-800 {
            color: #1f2937;
        }

        .border-primary\/20 {
            border-color: hsl(var(--primary) / 0.2);
        }

        /* Form validation styles */
        .form-error {
            color: var(--destructive);
            font-size: 0.875rem;
            margin-top: 0.25rem;
        }

        .input-error {
            border-color: var(--destructive);
        }

        /* Responsive design */
        @media (min-width: 768px) {
            .md\:grid-cols-2 {
                grid-template-columns: repeat(2, minmax(0, 1fr));
            }

            .md\:grid-cols-3 {
                grid-template-columns: repeat(3, minmax(0, 1fr));
            }

            .md\:col-span-2 {
                grid-column: span 2 / span 2;
            }

            .md\:p-6 {
                padding: 1.5rem;
            }

            .md\:px-6 {
                padding-left: 1.5rem;
                padding-right: 1.5rem;
            }
        }

        @media (min-width: 1024px) {
            .lg\:grid-cols-2 {
                grid-template-columns: repeat(2, minmax(0, 1fr));
            }

            .lg\:p-8 {
                padding: 2rem;
            }
        }

        /* Hidden class */
        .hidden {
            display: none;
        }

        /* Space utilities */
        .space-y-6 > * + * {
            margin-top: 1.5rem;
        }

        .space-y-3 > * + * {
            margin-top: 0.75rem;
        }

        .gap-2 {
            gap: 0.5rem;
        }

        .gap-3 {
            gap: 0.75rem;
        }

        /* Flex utilities */
        .flex-col {
            flex-direction: column;
        }

        .flex-wrap {
            flex-wrap: wrap;
        }

        .items-start {
            align-items: flex-start;
        }

        /* Size utilities */
        .mx-auto {
            margin-left: auto;
            margin-right: auto;
        }

        .opacity-90 {
            opacity: 0.9;
        }

        .opacity-50 {
            opacity: 0.5;
        }

        /* Display utilities */
        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border: 0;
        }
    </style>
</head>
<body>
    <div class="min-h-screen">
        <!-- Header -->
        <header class="gradient-bg py-6 px-4 shadow-lg" style="color: var(--primary-foreground);">
            <div class="container">
                <div class="flex items-center gap-3 mb-2">
                    <svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"/>
                    </svg>
                    <h1 class="text-3xl font-bold">AgriSmart</h1>
                </div>
                <p class="text-lg opacity-90">AI-Powered Crop Recommendation System</p>
            </div>
        </header>

        <main class="container p-4 md:p-6 lg:p-8">
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                
                <!-- Input Form -->
                <div class="card shadow-lg">
                    <div class="p-6">
                        <div class="flex items-center gap-3 mb-6">
                            <svg class="text-primary w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"/>
                            </svg>
                            <h2 class="text-2xl font-semibold">Environmental Parameters</h2>
                        </div>
                        
                        <form id="cropForm" class="space-y-6">
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                
                                <!-- Rainfall Input -->
                                <div>
                                    <label class="label">
                                        <svg class="text-blue-500 w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 15a4 4 0 004 4h9a5 5 0 10-.1-9.999 5.002 5.002 0 10-9.78 2.096A4.002 4.002 0 003 15z"/>
                                        </svg>
                                        Rainfall (mm/year)
                                    </label>
                                    <input
                                        type="number"
                                        id="rainfall"
                                        name="rainfall"
                                        placeholder="e.g. 1200"
                                        step="0.1"
                                        min="0"
                                        max="5000"
                                        class="input"
                                        data-testid="input-rainfall"
                                        required
                                    />
                                    <p class="text-xs text-muted-foreground mt-1">Annual rainfall in millimeters</p>
                                    <div class="form-error" id="rainfall-error"></div>
                                </div>

                                <!-- Humidity Input -->
                                <div>
                                    <label class="label">
                                        <svg class="text-blue-400 w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"/>
                                        </svg>
                                        Humidity (%)
                                    </label>
                                    <input
                                        type="number"
                                        id="humidity"
                                        name="humidity"
                                        placeholder="e.g. 65"
                                        step="0.1"
                                        min="0"
                                        max="100"
                                        class="input"
                                        data-testid="input-humidity"
                                        required
                                    />
                                    <p class="text-xs text-muted-foreground mt-1">Relative humidity percentage</p>
                                    <div class="form-error" id="humidity-error"></div>
                                </div>

                                <!-- Temperature Input -->
                                <div>
                                    <label class="label">
                                        <svg class="text-red-500 w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"/>
                                        </svg>
                                        Temperature (°C)
                                    </label>
                                    <input
                                        type="number"
                                        id="temperature"
                                        name="temperature"
                                        placeholder="e.g. 25"
                                        step="0.1"
                                        min="-10"
                                        max="50"
                                        class="input"
                                        data-testid="input-temperature"
                                        required
                                    />
                                    <p class="text-xs text-muted-foreground mt-1">Average temperature in Celsius</p>
                                    <div class="form-error" id="temperature-error"></div>
                                </div>

                                <!-- Phosphorus Input -->
                                <div>
                                    <label class="label">
                                        <svg class="text-purple-500 w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19.428 15.428a2 2 0 00-1.022-.547l-2.387-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z"/>
                                        </svg>
                                        Phosphorus (mg/kg)
                                    </label>
                                    <input
                                        type="number"
                                        id="phosphorus"
                                        name="phosphorus"
                                        placeholder="e.g. 45"
                                        step="0.1"
                                        min="0"
                                        max="500"
                                        class="input"
                                        data-testid="input-phosphorus"
                                        required
                                    />
                                    <p class="text-xs text-muted-foreground mt-1">Phosphorus content in soil</p>
                                    <div class="form-error" id="phosphorus-error"></div>
                                </div>

                                <!-- Nitrogen Input -->
                                <div class="md:col-span-2">
                                    <label class="label">
                                        <svg class="text-green-500 w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"/>
                                        </svg>
                                        Nitrogen (mg/kg)
                                    </label>
                                    <input
                                        type="number"
                                        id="nitrogen"
                                        name="nitrogen"
                                        placeholder="e.g. 75"
                                        step="0.1"
                                        min="0"
                                        max="500"
                                        class="input"
                                        data-testid="input-nitrogen"
                                        required
                                    />
                                    <p class="text-xs text-muted-foreground mt-1">Nitrogen content in soil</p>
                                    <div class="form-error" id="nitrogen-error"></div>
                                </div>
                            </div>

                            <!-- Submit Button -->
                            <button 
                                type="submit" 
                                class="button button-primary w-full"
                                id="submitBtn"
                                data-testid="button-submit"
                            >
                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"/>
                                </svg>
                                Get Crop Recommendations
                            </button>

                            <!-- Error Display -->
                            <div class="alert alert-destructive hidden" id="generalError" data-testid="alert-error">
                                <div id="errorMessage">Failed to get recommendations. Please try again.</div>
                            </div>
                        </form>
                    </div>
                </div>

                <!-- Results Display -->
                <div class="card shadow-lg">
                    <div class="p-6">
                        <div class="flex items-center gap-3 mb-6">
                            <svg class="text-primary w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"/>
                            </svg>
                            <h2 class="text-2xl font-semibold">Recommendations</h2>
                        </div>

                        <!-- Empty State -->
                        <div class="text-center py-12" id="emptyState" data-testid="state-empty">
                            <svg class="w-16 h-16 text-muted-foreground opacity-50 mx-auto mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"/>
                            </svg>
                            <h3 class="text-lg font-medium text-muted-foreground mb-2">No Recommendations Yet</h3>
                            <p class="text-muted-foreground">Fill in the environmental parameters to get AI-powered crop recommendations.</p>
                        </div>

                        <!-- Loading State -->
                        <div class="text-center py-12 hidden" id="loadingState" data-testid="state-loading">
                            <svg class="w-16 h-16 text-primary mx-auto mb-4 animate-spin" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"/>
                            </svg>
                            <h3 class="text-lg font-medium mb-2">Analyzing Environmental Data</h3>
                            <p class="text-muted-foreground">Our AI is processing your soil and climate conditions...</p>
                        </div>

                        <!-- Results State -->
                        <div class="fade-in hidden" id="resultsState" data-testid="state-results">
                            <!-- Results will be dynamically inserted here -->
                        </div>
                    </div>
                </div>
            </div>

            <!-- Info Section -->
            <div class="card mt-8 shadow-lg">
                <div class="p-6">
                    <h3 class="text-xl font-semibold mb-4 flex items-center gap-2">
                        <svg class="text-yellow-500 w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"/>
                        </svg>
                        How It Works
                    </h3>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                        <div class="text-center">
                            <div class="w-16 h-16 bg-primary/10 rounded-full flex items-center justify-center mx-auto mb-3">
                                <svg class="text-primary w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"/>
                                </svg>
                            </div>
                            <h4 class="font-medium mb-2">1. Input Parameters</h4>
                            <p class="text-sm text-muted-foreground">
                                Enter your soil and climate data including rainfall, humidity, temperature, and nutrient levels.
                            </p>
                        </div>
                        <div class="text-center">
                            <div class="w-16 h-16 bg-primary/10 rounded-full flex items-center justify-center mx-auto mb-3">
                                <svg class="text-primary w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"/>
                                </svg>
                            </div>
                            <h4 class="font-medium mb-2">2. AI Analysis</h4>
                            <p class="text-sm text-muted-foreground">
                                Our advanced AI analyzes your data against crop requirements and historical agricultural patterns.
                            </p>
                        </div>
                        <div class="text-center">
                            <div class="w-16 h-16 bg-primary/10 rounded-full flex items-center justify-center mx-auto mb-3">
                                <svg class="text-primary w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"/>
                                </svg>
                            </div>
                            <h4 class="font-medium mb-2">3. Get Recommendations</h4>
                            <p class="text-sm text-muted-foreground">
                                Receive personalized crop recommendations with yield estimates and growing tips.
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </main>

        <!-- Footer -->
        <footer class="bg-muted/30 mt-12 py-8 px-4">
            <div class="container text-center">
                <p class="text-muted-foreground flex items-center justify-center gap-2">
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
                    </svg>
                    Powered by AI technology for accurate crop recommendations
                </p>
                <p class="text-sm text-muted-foreground mt-2">© 2024 AgriSmart. Helping farmers make informed decisions.</p>
            </div>
        </footer>
    </div>

    <script>
        // Crop recommendation database (offline data)
        const cropDatabase = {
            // High rainfall, moderate temperature crops
            rice: {
                cropName: "Rice",
                confidence: "95% Confidence",
                score: "9.5/10",
                yield: "4-6 tons/hectare",
                season: "Monsoon Season",
                reasoning: "Excellent match for high rainfall and warm temperatures. Rice thrives in waterlogged conditions with adequate nitrogen and phosphorus levels.",
                tags: ["High Yield", "Water Efficient", "Staple Crop", "Export Quality"],
                requirements: { minRainfall: 1000, maxRainfall: 3000, minTemp: 20, maxTemp: 35, minHumidity: 60 }
            },
            wheat: {
                cropName: "Wheat",
                confidence: "88% Confidence", 
                score: "8.8/10",
                yield: "3-4 tons/hectare",
                season: "Winter Season",
                reasoning: "Well-suited for moderate rainfall and cooler temperatures. Good nitrogen levels will support healthy grain development.",
                tags: ["Winter Crop", "Drought Tolerant", "High Protein", "Market Stable"],
                requirements: { minRainfall: 300, maxRainfall: 1000, minTemp: 10, maxTemp: 25, minHumidity: 40 }
            },
            corn: {
                cropName: "Corn (Maize)",
                confidence: "92% Confidence",
                score: "9.2/10", 
                yield: "6-8 tons/hectare",
                season: "Summer Season",
                reasoning: "Perfect for warm temperatures and moderate to high rainfall. High nitrogen content will boost kernel development.",
                tags: ["High Yield", "Versatile Use", "Feed Crop", "Biofuel"],
                requirements: { minRainfall: 500, maxRainfall: 2000, minTemp: 18, maxTemp: 32, minHumidity: 50 }
            },
            soybean: {
                cropName: "Soybean",
                confidence: "85% Confidence",
                score: "8.5/10",
                yield: "2-3 tons/hectare", 
                season: "Summer Season",
                reasoning: "Good fit for moderate rainfall and warm temperatures. As a legume, it can fix nitrogen naturally.",
                tags: ["Protein Rich", "Nitrogen Fixing", "Oil Crop", "Export Value"],
                requirements: { minRainfall: 400, maxRainfall: 1200, minTemp: 15, maxTemp: 30, minHumidity: 45 }
            },
            barley: {
                cropName: "Barley",
                confidence: "80% Confidence",
                score: "8.0/10",
                yield: "2-4 tons/hectare",
                season: "Winter Season", 
                reasoning: "Suitable for cooler temperatures and moderate rainfall. Tolerates lower nutrient levels well.",
                tags: ["Drought Tolerant", "Cool Season", "Feed Grain", "Brewing"],
                requirements: { minRainfall: 200, maxRainfall: 800, minTemp: 5, maxTemp: 20, minHumidity: 35 }
            },
            cotton: {
                cropName: "Cotton",
                confidence: "87% Confidence",
                score: "8.7/10",
                yield: "1-2 tons/hectare",
                season: "Summer Season",
                reasoning: "Thrives in warm temperatures with moderate rainfall. Requires good drainage and adequate phosphorus.",
                tags: ["Cash Crop", "Fiber Crop", "Export Value", "High Price"],
                requirements: { minRainfall: 500, maxRainfall: 1200, minTemp: 20, maxTemp: 35, minHumidity: 50 }
            },
            sugarcane: {
                cropName: "Sugarcane", 
                confidence: "94% Confidence",
                score: "9.4/10",
                yield: "60-80 tons/hectare",
                season: "Year Round",
                reasoning: "Excellent for high rainfall and warm temperatures. High nitrogen and phosphorus levels support vigorous growth.",
                tags: ["High Yield", "Sugar Crop", "Biofuel", "Long Term"],
                requirements: { minRainfall: 1200, maxRainfall: 4000, minTemp: 20, maxTemp: 40, minHumidity: 65 }
            },
            tomato: {
                cropName: "Tomato",
                confidence: "83% Confidence",
                score: "8.3/10",
                yield: "20-40 tons/hectare",
                season: "Spring/Summer",
                reasoning: "Good for moderate rainfall and warm temperatures. Requires balanced nutrition and good drainage.",
                tags: ["High Value", "Vegetable Crop", "Processing", "Fresh Market"],
                requirements: { minRainfall: 400, maxRainfall: 1000, minTemp: 18, maxTemp: 30, minHumidity: 60 }
            },
            potato: {
                cropName: "Potato",
                confidence: "86% Confidence", 
                score: "8.6/10",
                yield: "15-25 tons/hectare",
                season: "Cool Season",
                reasoning: "Suitable for moderate temperatures and rainfall. High phosphorus levels support excellent tuber development.",
                tags: ["Staple Crop", "High Nutrition", "Storage Crop", "Processing"],
                requirements: { minRainfall: 400, maxRainfall: 1000, minTemp: 10, maxTemp: 25, minHumidity: 55 }
            },
            chickpea: {
                cropName: "Chickpea",
                confidence: "78% Confidence",
                score: "7.8/10", 
                yield: "1-2 tons/hectare",
                season: "Winter Season",
                reasoning: "Adapted to lower rainfall and cooler temperatures. As a legume, fixes nitrogen naturally.",
                tags: ["Protein Crop", "Drought Tolerant", "Pulse Crop", "Nitrogen Fixing"],
                requirements: { minRainfall: 200, maxRainfall: 600, minTemp: 10, maxTemp: 25, minHumidity: 40 }
            }
        };

        // Form validation
        function validateForm(formData) {
            const errors = {};
            
            if (formData.rainfall < 0 || formData.rainfall > 5000) {
                errors.rainfall = "Rainfall must be between 0-5000mm";
            }
            if (formData.humidity < 0 || formData.humidity > 100) {
                errors.humidity = "Humidity must be between 0-100%";
            }
            if (formData.temperature < -10 || formData.temperature > 50) {
                errors.temperature = "Temperature must be between -10°C to 50°C";
            }
            if (formData.phosphorus < 0 || formData.phosphorus > 500) {
                errors.phosphorus = "Phosphorus must be between 0-500mg/kg";
            }
            if (formData.nitrogen < 0 || formData.nitrogen > 500) {
                errors.nitrogen = "Nitrogen must be between 0-500mg/kg";
            }
            
            return errors;
        }

        // Display validation errors
        function displayErrors(errors) {
            // Clear previous errors
            document.querySelectorAll('.form-error').forEach(el => el.textContent = '');
            document.querySelectorAll('.input').forEach(el => el.classList.remove('input-error'));
            
            // Display new errors
            for (const [field, message] of Object.entries(errors)) {
                const errorEl = document.getElementById(`${field}-error`);
                const inputEl = document.getElementById(field);
                if (errorEl && inputEl) {
                    errorEl.textContent = message;
                    inputEl.classList.add('input-error');
                }
            }
        }

        // Calculate crop suitability score
        function calculateSuitability(crop, params) {
            let score = 0;
            const req = crop.requirements;
            
            // Rainfall score (40% weight)
            if (params.rainfall >= req.minRainfall && params.rainfall <= req.maxRainfall) {
                score += 40;
            } else {
                const rainfallDiff = Math.min(
                    Math.abs(params.rainfall - req.minRainfall),
                    Math.abs(params.rainfall - req.maxRainfall)
                );
                score += Math.max(0, 40 - (rainfallDiff / 100));
            }
            
            // Temperature score (30% weight) 
            if (params.temperature >= req.minTemp && params.temperature <= req.maxTemp) {
                score += 30;
            } else {
                const tempDiff = Math.min(
                    Math.abs(params.temperature - req.minTemp),
                    Math.abs(params.temperature - req.maxTemp)
                );
                score += Math.max(0, 30 - tempDiff);
            }
            
            // Humidity score (20% weight)
            if (params.humidity >= req.minHumidity) {
                score += 20;
            } else {
                const humidityDiff = req.minHumidity - params.humidity;
                score += Math.max(0, 20 - humidityDiff / 2);
            }
            
            // Nutrient bonus (10% weight)
            if (params.nitrogen > 50 && params.phosphorus > 30) {
                score += 10;
            } else {
                score += Math.max(0, (params.nitrogen / 50 + params.phosphorus / 30) * 5);
            }
            
            return Math.min(100, Math.max(0, score));
        }

        // Get crop recommendations based on parameters
        function getCropRecommendations(params) {
            const recommendations = [];
            
            for (const [key, crop] of Object.entries(cropDatabase)) {
                const suitability = calculateSuitability(crop, params);
                if (suitability > 40) { // Only include crops with >40% suitability
                    recommendations.push({
                        ...crop,
                        suitability: suitability,
                        score: `${(suitability / 10).toFixed(1)}/10`
                    });
                }
            }
            
            // Sort by suitability score
            recommendations.sort((a, b) => b.suitability - a.suitability);
            
            if (recommendations.length === 0) {
                // Fallback recommendations for extreme conditions
                return [
                    {
                        cropName: "Barley",
                        confidence: "65% Confidence",
                        score: "6.5/10",
                        yield: "1-2 tons/hectare", 
                        season: "Cool Season",
                        reasoning: "Most tolerant option for current conditions. Consider soil improvement and irrigation adjustments.",
                        tags: ["Hardy Crop", "Stress Tolerant"]
                    }
                ];
            }
            
            return recommendations;
        }

        // Generate soil and fertilizer advice
        function generateAdvice(params) {
            let soilAdvice = "Based on your soil conditions: ";
            let fertilizerAdvice = "Fertilizer recommendations: ";
            
            if (params.nitrogen < 30) {
                soilAdvice += "Consider adding organic matter to improve nitrogen levels. ";
                fertilizerAdvice += "Apply nitrogen-rich fertilizers like urea or compost. ";
            } else if (params.nitrogen > 200) {
                soilAdvice += "Nitrogen levels are high - ensure good drainage to prevent leaching. ";
                fertilizerAdvice += "Reduce nitrogen application and focus on phosphorus and potassium. ";
            } else {
                soilAdvice += "Nitrogen levels are adequate for most crops. ";
                fertilizerAdvice += "Maintain current nitrogen levels with balanced fertilization. ";
            }
            
            if (params.phosphorus < 20) {
                soilAdvice += "Low phosphorus may limit root development. ";
                fertilizerAdvice += "Add phosphorus-rich fertilizers like rock phosphate. ";
            } else if (params.phosphorus > 100) {
                soilAdvice += "Phosphorus levels are excellent for crop growth. ";
                fertilizerAdvice += "Continue current phosphorus management practices. ";
            } else {
                soilAdvice += "Phosphorus levels are suitable for healthy growth. ";
                fertilizerAdvice += "Maintain phosphorus with standard fertilizer applications. ";
            }
            
            if (params.humidity < 40) {
                soilAdvice += "Consider mulching to retain soil moisture in low humidity conditions.";
            } else if (params.humidity > 80) {
                soilAdvice += "Ensure good drainage to prevent waterlogging in high humidity.";
            }
            
            return { soilAdvice, fertilizerAdvice };
        }

        // Display results
        function displayResults(recommendations, params) {
            const resultsContainer = document.getElementById('resultsState');
            const primary = recommendations[0];
            const alternatives = recommendations.slice(1, 4); // Show up to 3 alternatives
            const advice = generateAdvice(params);
            
            resultsContainer.innerHTML = `
                <!-- Primary Recommendation -->
                <div class="bg-primary/5 border border-primary/20 rounded-lg p-5 mb-4">
                    <div class="flex items-start justify-between mb-3">
                        <div class="flex items-center gap-3">
                            <div class="w-12 h-12 bg-primary/20 rounded-full flex items-center justify-center">
                                <svg class="text-primary w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.538 1.118l-3.976-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.197-1.538-1.118l1.518-4.674a1 1 0 00-.363-1.118l-3.976-2.888c-.784-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z"/>
                                </svg>
                            </div>
                            <div>
                                <h3 class="text-xl font-semibold" data-testid="text-primary-crop">
                                    ${primary.cropName}
                                </h3>
                                <div class="flex items-center gap-2">
                                    <span class="badge badge-default">Best Match</span>
                                    <span class="text-sm text-muted-foreground" data-testid="text-confidence">
                                        ${primary.confidence}
                                    </span>
                                </div>
                            </div>
                        </div>
                        <div class="text-right">
                            <div class="text-2xl font-bold text-primary" data-testid="text-score">
                                ${primary.score}
                            </div>
                            <div class="text-sm text-muted-foreground">Suitability Score</div>
                        </div>
                    </div>
                    
                    <div class="grid grid-cols-2 gap-4 mb-4">
                        <div class="text-center">
                            <div class="text-lg font-semibold" data-testid="text-yield">
                                ${primary.yield}
                            </div>
                            <div class="text-sm text-muted-foreground">Expected Yield</div>
                        </div>
                        <div class="text-center">
                            <div class="text-lg font-semibold" data-testid="text-season">
                                ${primary.season}
                            </div>
                            <div class="text-sm text-muted-foreground">Growing Season</div>
                        </div>
                    </div>

                    <div class="bg-background/50 rounded-lg p-3 mb-3">
                        <h4 class="font-medium mb-2">Why ${primary.cropName} is Recommended:</h4>
                        <p class="text-sm text-muted-foreground" data-testid="text-reasoning">
                            ${primary.reasoning}
                        </p>
                    </div>

                    <div class="flex flex-wrap gap-2">
                        ${primary.tags.map((tag, index) => `
                            <span class="badge bg-green-100 text-green-800" data-testid="tag-primary-${index}">
                                <svg class="w-3 h-3 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
                                </svg>
                                ${tag}
                            </span>
                        `).join('')}
                    </div>
                </div>

                <!-- Alternative Recommendations -->
                ${alternatives.length > 0 ? `
                    <div class="space-y-3">
                        ${alternatives.map((alt, index) => `
                            <div class="bg-accent/30 border border rounded-lg p-4" data-testid="card-alternative-${index}">
                                <div class="flex items-center justify-between mb-2">
                                    <div class="flex items-center gap-3">
                                        <div class="w-8 h-8 bg-secondary/20 rounded-full flex items-center justify-center">
                                            <div class="w-2 h-2 bg-secondary rounded-full"></div>
                                        </div>
                                        <h4 class="font-semibold" data-testid="text-alt-crop-${index}">
                                            ${alt.cropName}
                                        </h4>
                                    </div>
                                    <span class="text-lg font-bold text-secondary" data-testid="text-alt-score-${index}">
                                        ${alt.score}
                                    </span>
                                </div>
                                <p class="text-sm text-muted-foreground mb-2" data-testid="text-alt-reasoning-${index}">
                                    ${alt.reasoning}
                                </p>
                                <div class="flex gap-2">
                                    <span class="badge badge-outline bg-orange-100 text-orange-800">
                                        ${alt.season}
                                    </span>
                                    <span class="badge badge-outline bg-gray-100 text-gray-800">
                                        ${alt.yield}
                                    </span>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                ` : ''}

                <!-- Additional Information -->
                <div class="bg-muted/30 rounded-lg p-4 mt-6">
                    <h4 class="font-medium mb-3 flex items-center gap-2">
                        <svg class="text-primary w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
                        </svg>
                        Additional Recommendations
                    </h4>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 text-sm">
                        <div>
                            <h5 class="font-medium mb-1">Soil Management</h5>
                            <p class="text-muted-foreground" data-testid="text-soil-advice">
                                ${advice.soilAdvice}
                            </p>
                        </div>
                        <div>
                            <h5 class="font-medium mb-1">Fertilizer Tips</h5>
                            <p class="text-muted-foreground" data-testid="text-fertilizer-advice">
                                ${advice.fertilizerAdvice}
                            </p>
                        </div>
                    </div>
                </div>

                <!-- Reset Button -->
                <button 
                    type="button" 
                    class="button button-outline w-full mt-4"
                    onclick="resetForm()"
                    data-testid="button-reset"
                >
                    Analyze Different Parameters
                </button>
            `;
        }

        // Show different states
        function showState(stateName) {
            document.getElementById('emptyState').classList.add('hidden');
            document.getElementById('loadingState').classList.add('hidden'); 
            document.getElementById('resultsState').classList.add('hidden');
            document.getElementById('generalError').classList.add('hidden');
            
            if (stateName) {
                document.getElementById(stateName).classList.remove('hidden');
            }
        }

        // Reset form
        function resetForm() {
            document.getElementById('cropForm').reset();
            showState('emptyState');
            document.querySelectorAll('.form-error').forEach(el => el.textContent = '');
            document.querySelectorAll('.input').forEach(el => el.classList.remove('input-error'));
        }

        // Handle form submission
        document.getElementById('cropForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const formData = new FormData(this);
            const params = {
                rainfall: parseFloat(formData.get('rainfall')) || 0,
                humidity: parseFloat(formData.get('humidity')) || 0,
                temperature: parseFloat(formData.get('temperature')) || 0,
                phosphorus: parseFloat(formData.get('phosphorus')) || 0,
                nitrogen: parseFloat(formData.get('nitrogen')) || 0
            };
            
            // Validate input
            const errors = validateForm(params);
            if (Object.keys(errors).length > 0) {
                displayErrors(errors);
                return;
            }
            
            // Clear previous errors
            displayErrors({});
            
            // Show loading state
            showState('loadingState');
            
            // Simulate AI processing delay
            setTimeout(() => {
                try {
                    const recommendations = getCropRecommendations(params);
                    
                    if (recommendations.length === 0) {
                        throw new Error('No suitable crops found for these conditions');
                    }
                    
                    displayResults(recommendations, params);
                    showState('resultsState');
                    
                    // Save to localStorage for offline access
                    localStorage.setItem('lastRecommendation', JSON.stringify({
                        params,
                        recommendations,
                        timestamp: new Date().toISOString()
                    }));
                    
                } catch (error) {
                    document.getElementById('errorMessage').textContent = error.message;
                    showState('generalError');
                }
            }, 2000); // 2 second delay to simulate processing
        });

        // Load previous recommendation if available
        window.addEventListener('load', function() {
            const saved = localStorage.getItem('lastRecommendation');
            if (saved) {
                try {
                    const data = JSON.parse(saved);
                    // Only auto-load if less than 24 hours old
                    const hoursSince = (new Date() - new Date(data.timestamp)) / (1000 * 60 * 60);
                    if (hoursSince < 24) {
                        // Fill form with previous values
                        document.getElementById('rainfall').value = data.params.rainfall;
                        document.getElementById('humidity').value = data.params.humidity;
                        document.getElementById('temperature').value = data.params.temperature;
                        document.getElementById('phosphorus').value = data.params.phosphorus;
                        document.getElementById('nitrogen').value = data.params.nitrogen;
                    }
                } catch (error) {
                    console.log('Could not load previous recommendation');
                }
            }
        });

        // Add some sample data button for demo
        function addSampleData() {
            document.getElementById('rainfall').value = 1200;
            document.getElementById('humidity').value = 65;
            document.getElementById('temperature').value = 25;
            document.getElementById('phosphorus').value = 45;
            document.getElementById('nitrogen').value = 75;
        }

        // Add keyboard shortcut for sample data (Ctrl+S)
        document.addEventListener('keydown', function(e) {
            if (e.ctrlKey && e.key === 's') {
                e.preventDefault();
                addSampleData();
            }
        });
    </script>
</body>
</html>